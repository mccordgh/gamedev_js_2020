!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t){t.exports={a:{sender:"MGMT",subject:"Re: John Smith",text:["Regarding John:","","There has been an incident with John Smith.","","I've given you access to the Footage app.","Please review the footage of John.","We need him alive...","","Thanks,","MGMT"]}}},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.managerHandler=e,this.world=n}var e,n,r;return e=t,(n=[{key:"tick",value:function(t){this.world.tick(t)}},{key:"render",value:function(t){this.world.render(t)}},{key:"getManagerHandler",value:function(){return this.managerHandler}},{key:"getWorld",value:function(){return this.world}},{key:"setWorld",value:function(t){this.world=t}}])&&i(e.prototype,n),r&&i(e,r),t}();function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.managerHandler=e,this.initializeEvents()}var e,n,i;return e=t,(n=[{key:"getMouseXFromEvent",value:function(t){return t.offsetX}},{key:"getMouseYFromEvent",value:function(t){return t.offsetY}},{key:"initializeEvents",value:function(){var t=this,e=this.managerHandler.getGraphicsManager().getCanvas();e.onclick=function(e){var n=t.getMouseXFromEvent(e),i=t.getMouseYFromEvent(e);t.managerHandler.event("click",{x:n,y:i})},e.onmousemove=function(e){var n=t.getMouseXFromEvent(e),i=t.getMouseYFromEvent(e);t.managerHandler.event("move",{x:n,y:i})}}}])&&o(e.prototype,n),i&&o(e,i),t}(),s=window.location.href,h={BIG_FONT_SIZE:32,FONT_SIZE:18,EMAIL_ITEM_SIZE:16,APP_NAME_SIZE:16,APPS:{FOOTAGE:"Footage",EMAIL:"Email"},COLORS:{PURPLE:"#7B538F",LIGHT_PURPLE:"#BD7FDB",DARK_PURPLE:"#4F355C",CREAM:"#FCEDC3",RED:"#FF2F4C",LIGHT_RED:"#FF7A8C",DARK_RED:"#803D46"},FPS:60,DIALOGUE:{X:64,Y:448,WIDTH:896,HEIGHT:256/1.5},SCREEN_WIDTH:512,SCREEN_HEIGHT:384,GAME_WIDTH:1024,GAME_HEIGHT:768,ICON_HEIGHT:64,ICON_WIDTH:64,SPATIAL_GRID_SIZE:64,RADIO_WIDTH:133,RADIO_HEIGHT:74,TYPES:{EMAIL_ITEMS:"email-items",EMAIL_INBOX_ITEMS:"email-inbox-items",FOOTAGE_ITEMS:"footage-items",FOOTAGE_LIBRARY_ITEMS:"footage-library-items",INTERACTIVE:"interactive",COMPUTER:"computer",COMPUTER_APP:"computer-app"},FINGER_WIDTH:16,BASE_PATH:s=s.replace(/index.html/,""),ASSETS_PATH:"".concat(s,"src/resources"),MUSIC_PATH:"".concat(s,"src/music")};function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.customizeContext(),this.initializeCanvas(),this.initializeGraphics()}var e,n,i;return e=t,(n=[{key:"customizeContext",value:function(){var t=this;CanvasRenderingContext2D.prototype.drawSprite=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;r||(r=e.width),o||(o=e.height),t.graphics.drawImage(e.sheet,e.x,e.y,e.width,e.height,n,i,r,o)},CanvasRenderingContext2D.prototype.drawText=function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.COLORS.CREAM,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:h.FONT_SIZE;t.graphics.font="".concat(a,"px Arial"),o&&(t.graphics.fillStyle="black"===r,t.graphics.fillText(e,n-1,i+1)),t.graphics.fillStyle=r,t.graphics.fillText(e,n,i)}}},{key:"initializeCanvas",value:function(){this.canvas=document.querySelector("#canvas"),this.canvas.setAttribute("width",h.GAME_WIDTH),this.canvas.setAttribute("height",h.GAME_HEIGHT)}},{key:"initializeGraphics",value:function(){this.graphics=this.canvas.getContext("2d"),this.graphics.imageSmoothingEnabled=!1,this.graphics.webkitImageSmoothingEnabled=!1}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getGraphics",value:function(){return this.graphics}}])&&u(e.prototype,n),i&&u(e,i),t}();function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=e,this.index=0,this.lastTime=Date.now(),this.timer=0,this.speed=this.frames[this.index].speed}var e,n,i;return e=t,(n=[{key:"tick",value:function(){if(this.timer+=Date.now()-this.lastTime,this.lastTime=Date.now(),!this.speed)throw new Error("SPEED NOT DEFINED FOR",this);this.timer>=this.speed&&(this.index+=1,this.timer=0,this.index>=this.frames.length&&(this.index=0))}},{key:"getCurrentFrame",value:function(){return this.frames[this.index].frame}}])&&l(e.prototype,n),i&&l(e,i),t}();function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"loadImage",value:function(t){var e=new Image;return e.src=t,e}}],(n=null)&&d(e.prototype,n),i&&d(e,i),t}();function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e}var e,n,i;return e=t,(n=[{key:"crop",value:function(t,e,n,i){return{sheet:this.sheet,x:t,y:e,width:n,height:i}}}])&&p(e.prototype,n),i&&p(e,i),t}();function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v={},w=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),v[e]=this,this.name=e,this.path="".concat(h.ASSETS_PATH,"/").concat(n),this.sheet=new g(y.loadImage(this.path)),this.animations={}}var e,n,i;return e=t,i=[{key:"getAssets",value:function(t){return v[t]}}],(n=[{key:"addAnimation",value:function(t,e){this.animations[t]=e}}])&&b(e.prototype,n),i&&b(e,i),t}(),E=function(t,e,n){n.frames=[];for(var i=n.col;i<n.length+n.col;i+=1)n.frames.push({frame:t.sheet.crop(n.width*i,n.height*n.row,n.width,n.height),speed:n.speed});t.addAnimation(e,new f(n.frames))},m=new w("cursor","cursor.png");m.pointer=m.sheet.crop(0,0,49,56);var I=new w("cursor2","cursor2.png");I.pointer=I.sheet.crop(0,0,32,32);var T=new w("whiteCursor","white-cursor.png");T.pointer=T.sheet.crop(0,0,32,32);var k=new w("hand","hand.png");k.pointer=k.sheet.crop(0,0,64,64);var O=new w("hand2","hand2.png");O.pointer=O.sheet.crop(0,0,32,32);var S=new w("background","gameJamBg.png");S.image=S.sheet.crop(0,0,h.GAME_WIDTH,h.GAME_HEIGHT);var A=new w("email","email.png");A.icon=A.sheet.crop(0,0,h.ICON_WIDTH,h.ICON_HEIGHT),E(A,"loading",{speed:240,row:0,col:0,length:10,width:h.ICON_WIDTH,height:h.ICON_HEIGHT});var _=new w("footage","footage.png");_.icon=_.sheet.crop(0,0,h.ICON_WIDTH,h.ICON_HEIGHT),E(_,"loading",{speed:240,row:0,col:0,length:10,width:h.ICON_WIDTH,height:h.ICON_HEIGHT});var M=new w("bigFootage","big-footage.png");M.playButton=M.sheet.crop(0,0,h.SCREEN_WIDTH,h.SCREEN_HEIGHT),E(new w("johnDies","john-dies.png"),"playing",{speed:200,row:0,col:0,length:10,width:h.SCREEN_WIDTH,height:h.SCREEN_HEIGHT}),E(new w("johnLives","john-lives.png"),"playing",{speed:200,row:0,col:0,length:10,width:h.SCREEN_WIDTH,height:h.SCREEN_HEIGHT}),E(new w("os","jam-os-bootup.png"),"booting",{speed:300,row:0,col:0,length:10,width:h.SCREEN_WIDTH,height:h.SCREEN_HEIGHT});var P=new w("inbox","inbox-bg.png");P.bg=P.sheet.crop(0,0,768,672);var C=new w("footageLibrary","footage-library-bg.png");C.bg=C.sheet.crop(0,0,768,672);var x=new w("radio","radio.png");x.off=x.sheet.crop(0,0,h.RADIO_WIDTH,h.RADIO_HEIGHT),x.station1=x.sheet.crop(h.RADIO_WIDTH,0,h.RADIO_WIDTH,h.RADIO_HEIGHT),x.station2=x.sheet.crop(2*h.RADIO_WIDTH,0,h.RADIO_WIDTH,h.RADIO_HEIGHT),x.station3=x.sheet.crop(3*h.RADIO_WIDTH,0,h.RADIO_WIDTH,h.RADIO_HEIGHT);var H=new w("radioBanner","radio-banner.png");function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}H.img=H.sheet.crop(0,0,225,225);var G=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=null,this.y=null,this.handBounds={x:4,y:4,width:24,height:24},this.arrowBounds={x:0,y:0,width:12,height:12},this.assets={hand:w.getAssets("hand2").pointer,arrow:w.getAssets("cursor2").pointer},this.swapToComputer()}var e,n,i;return e=t,(n=[{key:"render",value:function(t){var e=this.cursor===this.assets.hand,n=e?16:0,i=e?64:32;t.drawSprite(this.cursor,this.x-n,this.y-n,i,i)}},{key:"swapToComputer",value:function(){this.cursor=this.assets.arrow,this.bounds=this.arrowBounds}},{key:"swapToHand",value:function(){this.cursor=this.assets.hand,this.bounds=this.handBounds}}])&&j(e.prototype,n),i&&j(e,i),t}();function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var D=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.width=i,this.height=r}var e,n,i;return e=t,(n=[{key:"intersects",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}])&&R(e.prototype,n),i&&R(e,i),t}();function N(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var L=[h.TYPES.INTERACTIVE,h.TYPES.COMPUTER_APP,h.TYPES.EMAIL_ITEMS,h.TYPES.EMAIL_INBOX_ITEMS,h.TYPES.FOOTAGE_ITEMS,h.TYPES.FOOTAGE_LIBRARY_ITEMS],B=[h.TYPES.COMPUTER_APP,h.TYPES.EMAIL_INBOX_ITEMS,h.TYPES.FOOTAGE_LIBRARY_ITEMS],W=(h.TYPES.COMPUTER,h.TYPES.COMPUTER_APP,h.TYPES.EMAIL_ITEMS,h.TYPES.EMAIL_INBOX_ITEMS,h.TYPES.FOOTAGE_ITEMS,h.TYPES.FOOTAGE_LIBRARY_ITEMS,1),Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.lastEntityHovered=null,this.cursor=new G,this.entities=[]}var e,n,i;return e=t,(n=[{key:"tick",value:function(t){for(var e=0;e<this.entities.length;e+=1)this.entities[e].tick(t)}},{key:"render",value:function(t){for(var e=0;e<this.entities.length;e+=1){var n=this.entities[e];B.includes(n.type)||this.entities[e].render(t)}this.cursor.x&&this.cursor.y&&this.cursor.render(t)}},{key:"addEntity",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.id=W,W+=1,e?this.entities.unshift(t):this.entities.push(t);var n=new D(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height);return this.handler.getWorld().getSpatialGrid().insert(n,t),t}},{key:"findEntityByName",value:function(t){return this.entities.find((function(e){return e.name===t}))}},{key:"removeEntity",value:function(t){var e=this.entities.indexOf(t);this.handler.getWorld().getSpatialGrid().remove(new D(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height),t),this.entities.splice(e,1),t=void 0}},{key:"findClickableEntityAt",value:function(t,e){var n=new D(this.cursor.x+this.cursor.bounds.x,this.cursor.y+this.cursor.bounds.y,this.cursor.bounds.width,this.cursor.bounds.height);return N(this.entities).reverse().find((function(t){if(!t.bounds)throw new Error("entity type ".concat(t.type," has no bounds"));var e=new D(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height);return n.intersects(e)&&L.includes(t.type)}))}},{key:"mouseClick",value:function(t){var e=t.x,n=t.y,i=this.findClickableEntityAt(e,n);i&&i.wasClickedAt&&i.wasClickedAt(e,n)}},{key:"mouseMove",value:function(t){var e=t.x,n=t.y;this.cursor.x=e,this.cursor.y=n;var i=this.findClickableEntityAt(e,n);i?i&&this.lastEntityHovered&&i.id===this.lastEntityHovered.id||(this.lastEntityHovered&&this.lastEntityHovered.wasBlurred&&this.lastEntityHovered.wasBlurred(),i.wasHoveredAt&&i.wasHoveredAt(e,n),this.lastEntityHovered=i):this.lastEntityHovered&&this.lastEntityHovered.wasBlurred&&(this.lastEntityHovered.wasBlurred(),this.lastEntityHovered=null)}},{key:"getEntitiesByType",value:function(t){return this.entities.filter((function(e){return e.type==t}))}}])&&F(e.prototype,n),i&&F(e,i),t}();function z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"construct",value:function(){this.currentState=null}},{key:"getState",value:function(){return this.currentState}},{key:"setState",value:function(t){this.currentState=t}}])&&z(e.prototype,n),i&&z(e,i),t}();function X(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Z=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=parseInt(e/i),this.height=parseInt(n/i),this.size=i,this.grid=[];for(var r=0;r<=this.width;r++){this.grid[r]=[];for(var o=0;o<=this.height;o++)this.grid[r][o]=[]}}var e,n,i;return e=t,(n=[{key:"insert",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)-1===this.grid[s][a].indexOf(e)&&this.grid[s][a].push(e)}},{key:"retrieve",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=[],s=i;s<=o;s++)for(var h=n;h<=r;h++)this.grid[h][s].forEach((function(t){t!==e&&-1===a.indexOf(t)&&a.push(t)}));return a}},{key:"remove",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)for(var h=0;h<this.grid[s][a].length;h++)this.grid[s][a][h]===e&&this.grid[s][a].splice(h,1)}},{key:"reset",value:function(){for(var t=0;t<=this.width;t++){this.grid[t]=[];for(var e=0;e<=this.height;e++)this.grid[t][e]=[]}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return this.size}},{key:"render",value:function(t){for(var e=0;e<=this.height;e++)for(var n=0;n<=this.width;n++){var i=n*this.size,r=e*this.size;t.fillStyle="orange",t.strokeRect(i,r,this.size,this.size),this.grid[n][e].length>0&&(t.fillStyle="yellow",t.fillRect(i,r,this.size,this.size))}}}])&&X(e.prototype,n),i&&X(e,i),t}();function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var J=[h.TYPES.GARDEN,h.TYPES.PLOT,h.TYPES.LANE];function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tt=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=K(this,Q(e).call(this,t,n,i))).handler=t,r.bounds={x:0,y:0,width:0,height:0},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(e,t),e}(function(){function t(e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.x=n,this.y=i,this.bounds=new D(0,0,this.width,this.height)}var e,n,i;return e=t,(n=[{key:"tick",value:function(){throw new Error("".concat(this.constructor.name," did not implement tick() method"))}},{key:"getCollisionBounds",value:function(t,e){var n=parseInt(this.x+this.bounds.x+t,10),i=parseInt(this.y+this.bounds.y+e);return new D(n,i,this.bounds.width,this.bounds.height)}},{key:"checkEntityCollisions",value:function(t,e){var n=this.handler.getWorld().getSpatialGrid().retrieve(new D(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this);n=n.filter((function(t){return!J.includes(t.type)}));for(var i=0;i<n.length;i++)if(n[i].getCollisionBounds(0,0).intersects(this.getCollisionBounds(t,e)))return!0;return!1}},{key:"drawCollisionBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blue";t.fillStyle=e,t.fillRect(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height)}},{key:"destroySelf",value:function(){this.handler.getEntityManager().removeEntity(this)}}])&&V(e.prototype,n),i&&V(e,i),t}());function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rt(t,e){return!e||"object"!==et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var st=function(t){function e(t,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return nt(this,e),(i=rt(this,ot(e).call(this,t,r,o))).handler=t,i.name=n,i.nameWidth=t.getGraphicsManager().getGraphics().measureText(i.name).width,i.x=r,i.y=o,i.width=h.ICON_WIDTH,i.height=h.ICON_HEIGHT,i.type=h.TYPES.COMPUTER_APP,i.yPadding=22,i.hovered=!1,i.state="idle",i}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){switch(this.state){case"idle":break;case"loading":var t=this.assets.animations.loading;if(t.index>=9)return this.appLoaded(),t.index=0,void(this.state="inactive");t.tick();break;case"inactive":break;default:throw new Error('Computer App animation state "'.concat(this.state," is not accounted for"))}}},{key:"getCurrentAnimationFrame",value:function(){switch(this.state){case"idle":break;case"loading":return this.assets.animations.loading.getCurrentFrame();case"inactive":break;default:throw new Error('Computer App animation state "'.concat(this.state," is not accounted for"))}}},{key:"render",value:function(t){switch(this.state){case"idle":t.drawSprite(this.assets.icon,this.x,this.y,this.width,this.height),this.hovered&&(t.globalAlpha=.4,t.fillStyle="black",t.fillRect(this.x+this.bounds.x-6,this.y+this.bounds.y-6,this.bounds.width+12,this.bounds.height+12+h.FONT_SIZE+2),t.globalAlpha=1);break;case"loading":t.drawSprite(this.getCurrentAnimationFrame(),this.x,this.y,this.width,this.height);break;case"inactive":break;default:throw new Error('Computer App state "'.concat(this.state," is not accounted for"))}}},{key:"wasClickedAt",value:function(t,e){switch(this.hovered=!1,this.state){case"idle":this.state="loading";break;case"loading":case"inactive":break;default:throw new Error('Computer App state "'.concat(this.state," is not accounted for during mouseclicked"))}}},{key:"wasHoveredAt",value:function(t,e){"inactive"!==this.state&&"loading"!==this.state&&(this.hovered=!0)}},{key:"wasBlurred",value:function(){"inactive"!==this.state&&"loading"!==this.state&&(this.hovered=!1)}}])&&it(n.prototype,i),r&&it(n,r),e}(tt);function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yt=function(t){function e(t,n){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return ut(this,e),(i=lt(this,ft(e).call(this,t,0,0))).x=0,i.y=0,i.bounds={x:0,y:0,width:h.GAME_WIDTH,height:h.GAME_HEIGHT},i.type=h.TYPES.INTERACTIVE,i.textArray=n.text,i.isRead=r,i.sender=n.sender,i.subject=n.subject,o&&(i.unlocksOnOpen=o),i}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){}},{key:"drawFadedBackground",value:function(t){var e=this.bounds,n=e.x,i=e.y,r=e.width,o=e.height;t.globalAlpha=.4,t.fillStyle="black",t.fillRect(n,i,r,o),t.globalAlpha=1}},{key:"render",value:function(t){this.drawFadedBackground(t),this.drawPaperAndText(t)}},{key:"drawPaperAndText",value:function(t){var e=h.GAME_WIDTH/8,n=h.GAME_HEIGHT/16,i=h.GAME_WIDTH-2*e,r=h.GAME_HEIGHT-2*n;t.fillStyle="white",t.fillRect(e,n,i,r);for(var o=e+64,a=n+64,s=0;s<this.textArray.length;s+=1)t.drawText(this.textArray[s],o,a,"black",!1,h.BIG_FONT_SIZE),a+=h.BIG_FONT_SIZE+16}},{key:"wasClickedAt",value:function(){this.setHiddenCallback(!1),this.handler.getEntityManager().removeEntity(this)}}])&&ct(n.prototype,i),r&&ct(n,r),e}(tt),pt=n(0);function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vt(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mt=function(t){function e(t,n,i,r,o,a,s,u,c){var l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=vt(this,wt(e).call(this,t,n,i))).width=r,l.height=o,l.email=a,l.bgColor=s,l.highlightColor=u,l.hovered=!1,l.bounds={x:-16,y:-26,width:l.width,height:l.height},l.type=h.TYPES.EMAIL_INBOX_ITEMS,l.setHiddenCallback=c,l.hidden=!1,l}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){}},{key:"render",value:function(t){if(!this.hidden){var e=this.x,n=this.y,i=this.width,r=this.height;t.fillStyle=this.hovered?this.highlightColor:this.bgColor,t.fillRect(e-16,n-26,i,r),t.fillStyle="black",t.drawText(this.email.sender,this.x,this.y-4,"white",!1,h.EMAIL_ITEM_SIZE),t.drawText(this.email.subject,this.x+224,this.y-4,"white",!1,h.EMAIL_ITEM_SIZE)}}},{key:"wasHoveredAt",value:function(t,e){this.hovered=!0}},{key:"wasBlurred",value:function(){this.hovered=!1}},{key:"wasClickedAt",value:function(){this.setHiddenCallback(!0),this.email.isRead=!0,this.email.setHiddenCallback=this.setHiddenCallback,this.handler.getEntityManager().addEntity(this.email),this.email.unlocksOnOpen&&this.handler.getEmailManager().unlockApp(this.email.unlocksOnOpen)}}])&&bt(n.prototype,i),r&&bt(n,r),e}(tt);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function kt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var At=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=kt(this,Ot(e).call(this,t,0,0))).x=0,r.y=0,r.paddingX=h.GAME_WIDTH/8,r.paddingY=h.GAME_HEIGHT/16,r.width=h.GAME_WIDTH-2*r.paddingX,r.height=h.GAME_HEIGHT-2*r.paddingY,r.setActiveCallback=i,r.bounds={x:850,y:52,width:34,height:30},r.type=h.TYPES.EMAIL_ITEMS,r.hidden=!1,r.emails=n,r.assets=w.getAssets("inbox"),r.emailItems=[],r.initializeEmailItems(),r}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){}},{key:"initializeEmailItems",value:function(){for(var t=this.paddingX+16,e=this.paddingY+64+38,n=0;n<this.emails.length;n+=1){var i=this.emails[n],r=n%2?h.COLORS.PURPLE:h.COLORS.RED,o=n%2?h.COLORS.LIGHT_PURPLE:h.COLORS.LIGHT_RED,a=new mt(this.handler,t,e,this.width,34,i,r,o,this.setHidden.bind(this));this.handler.getEntityManager().addEntity(a),this.emailItems.push(a),e+=36}}},{key:"drawFadedBackground",value:function(t){t.globalAlpha=.4,t.fillStyle="black",t.fillRect(0,0,h.GAME_WIDTH,h.GAME_HEIGHT),t.globalAlpha=1}},{key:"render",value:function(t){this.hidden||(this.drawFadedBackground(t),this.drawInbox(t),this.drawEmailItems(t))}},{key:"setHidden",value:function(t){this.hidden=t;for(var e=0;e<this.emailItems.length;e+=1)this.emailItems[e].hidden=t}},{key:"drawEmailItems",value:function(t){for(var e=0;e<this.emailItems.length;e+=1)this.emailItems[e].render(t)}},{key:"drawInbox",value:function(t){t.drawSprite(this.assets.bg,this.paddingX,this.paddingY,this.width,this.height)}},{key:"wasClickedAt",value:function(){for(var t=this.handler.getEntityManager(),e=0;e<this.emailItems.length;e+=1)t.removeEntity(this.emailItems[e]);t.removeEntity(this),this.setActiveCallback()}}])&&Tt(n.prototype,i),r&&Tt(n,r),e}(tt);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pt(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xt(t,e){return(xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ht=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Pt(this,Ct(e).call(this,t,h.APPS.EMAIL))).bounds={x:0,y:26,width:n.width,height:36},n.textXOffset=10,n.textYOffset=n.height+18,n.assets=w.getAssets("email"),n.emails=[new yt(n.handler,pt.a,!1,h.APPS.FOOTAGE)],n}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xt(t,e)}(e,t),n=e,(i=[{key:"setActive",value:function(){this.state="idle"}},{key:"appLoaded",value:function(){this.handler.getEntityManager().addEntity(new At(this.handler,this.emails,this.setActive.bind(this)))}}])&&Mt(n.prototype,i),r&&Mt(n,r),e}(st);function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rt(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nt(t,e){return(Nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(t){function e(t,n,i,r,o,a,s,u,c){var l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=Rt(this,Dt(e).call(this,t,n,i))).width=r,l.height=o,l.video=a,l.bgColor=s,l.highlightColor=u,l.hovered=!1,l.bounds={x:-16,y:-26,width:l.width,height:l.height},l.type=h.TYPES.FOOTAGE_LIBRARY_ITEMS,l.setHiddenCallback=c,l.hidden=!1,l}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nt(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){}},{key:"render",value:function(t){if(!this.hidden){var e=this.x,n=this.y,i=this.width,r=this.height;t.fillStyle=this.hovered?this.highlightColor:this.bgColor,t.fillRect(e-16,n-26,i,r),t.fillStyle="black",t.drawText(this.video.video.who,this.x,this.y-4,"white",!1,h.EMAIL_ITEM_SIZE),t.drawText(this.video.video.status||"N/A (Please watch video)",this.x+224,this.y-4,"white",!1,h.EMAIL_ITEM_SIZE)}}},{key:"wasHoveredAt",value:function(t,e){this.hovered=!0}},{key:"wasBlurred",value:function(){this.hovered=!1}},{key:"wasClickedAt",value:function(){this.setHiddenCallback(!0),this.video.video.isViewed=!0,this.video.setHiddenCallback=this.setHiddenCallback,this.handler.getEntityManager().addEntity(this.video)}}])&&Gt(n.prototype,i),r&&Gt(n,r),e}(tt);function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wt(t,e){return!e||"object"!==Lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ut=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Wt(this,Yt(e).call(this,t,0,0))).x=0,r.y=0,r.paddingX=h.GAME_WIDTH/8,r.paddingY=h.GAME_HEIGHT/16,r.width=h.GAME_WIDTH-2*r.paddingX,r.height=h.GAME_HEIGHT-2*r.paddingY,r.setActiveCallback=i,r.bounds={x:850,y:52,width:34,height:30},r.type=h.TYPES.FOOTAGE_ITEMS,r.hidden=!1,r.footage=n,r.assets=w.getAssets("footageLibrary"),r.footageItems=[],r.initializeFootageItems(),r}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){}},{key:"initializeFootageItems",value:function(){for(var t=this.paddingX+16,e=this.paddingY+64+38,n=0;n<this.footage.length;n+=1){var i=this.footage[n],r=new Ft(this.handler,t,e,this.width,34,i,"black","grey",this.setHidden.bind(this));this.handler.getEntityManager().addEntity(r),this.footageItems.push(r),e+=36}}},{key:"drawFadedBackground",value:function(t){t.globalAlpha=.4,t.fillStyle="black",t.fillRect(0,0,h.GAME_WIDTH,h.GAME_HEIGHT),t.globalAlpha=1}},{key:"render",value:function(t){this.hidden||(this.drawFadedBackground(t),this.drawLibrary(t),this.drawFootageItems(t))}},{key:"setHidden",value:function(t){this.hidden=t;for(var e=0;e<this.footageItems.length;e+=1)this.footageItems[e].hidden=t}},{key:"drawFootageItems",value:function(t){for(var e=0;e<this.footageItems.length;e+=1)this.footageItems[e].render(t)}},{key:"drawLibrary",value:function(t){t.drawSprite(this.assets.bg,this.paddingX,this.paddingY,this.width,this.height)}},{key:"wasClickedAt",value:function(){for(var t=this.handler.getEntityManager(),e=0;e<this.footageItems.length;e+=1)t.removeEntity(this.footageItems[e]);t.removeEntity(this),this.setActiveCallback()}}])&&Bt(n.prototype,i),r&&Bt(n,r),e}(tt);function Xt(t){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Jt(t,e){return!e||"object"!==Xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qt=function(t){function e(t,n,i,r){var o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return Zt(this,e),(o=Jt(this,qt(e).call(this,t,n,i))).x=n,o.y=i,o.bounds={x:0,y:0,width:h.GAME_WIDTH,height:h.GAME_HEIGHT},o.type=h.TYPES.INTERACTIVE,o.isViewed=a,o.video=r,o.states={IDLE:"idle",PLAYING:"playing",FINISHED:"finished"},o.assets=w.getAssets("bigFootage"),o.state=o.states.IDLE,o}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){switch(this.state){case this.states.FINISHED:case this.states.IDLE:break;case this.states.PLAYING:var t=this.video.assets.animations[this.states.PLAYING];if(t.index>=9)return this.video.status="death"===this.video.type?"Deceased":"Alive",console.log(this.video.type),"alive"===this.video.type&&(console.log("just watched best vid"),this.handler.getFootageManager().updateWatchedBestVideo()),void(this.state=this.states.FINISHED);t.tick();break;default:throw new Error("Big Footage unrecognized state: ".concat(this.state))}}},{key:"drawFadedBackground",value:function(t){var e=this.bounds,n=e.x,i=e.y,r=e.width,o=e.height;t.globalAlpha=.4,t.fillStyle="black",t.fillRect(n,i,r,o),t.globalAlpha=1}},{key:"getCurrentAnimationFrame",value:function(){switch(this.state){case this.states.IDLE:break;case this.states.FINISHED:case this.states.PLAYING:return this.video.assets.animations[this.states.PLAYING].getCurrentFrame();default:throw new Error('Big Footage animation state "'.concat(this.state," is not accounted for"))}}},{key:"render",value:function(t){switch(this.drawFadedBackground(t),this.state){case this.states.IDLE:t.drawSprite(this.assets.playButton,this.x,this.y,this.width,this.height);break;case this.states.FINISHED:t.drawSprite(this.getCurrentAnimationFrame(),this.x,this.y,this.width,this.height),t.fillStyle="black",t.globalAlpha=.6,t.fillRect(this.x,this.y,this.assets.playButton.width,this.assets.playButton.height),t.globalAlpha=1,t.fillStyle="black",t.drawText("X",this.x+this.assets.playButton.height+60,this.y+80,"white",!0,64);break;case this.states.PLAYING:t.drawSprite(this.getCurrentAnimationFrame(),this.x,this.y,this.width,this.height);break;default:throw new Error("Big Footage unrecognized state: ".concat(this.state))}}},{key:"wasClickedAt",value:function(){switch(this.state){case this.states.IDLE:this.state=this.states.PLAYING;break;case this.states.PLAYING:break;case this.states.FINISHED:this.video.assets.animations[this.states.PLAYING].index=0,this.setHiddenCallback(!1),this.state=this.states.IDLE,this.handler.getFootageManager().isLogComplete()&&this.handler.getWorld().gameWon(),this.handler.getEntityManager().removeEntity(this);break;default:throw new Error("Big Footage wasClicked unrecognized state: ".concat(this.state))}}}])&&Vt(n.prototype,i),r&&Vt(n,r),e}(tt);function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ee(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ne(t,e){return!e||"object"!==$t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ie(t){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function re(t,e){return(re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oe=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ne(this,ie(e).call(this,t,h.APPS.FOOTAGE))).bounds={x:0,y:26,width:n.width,height:36},n.textXOffset=0,n.textYOffset=n.height+18,n.assets=w.getAssets("footage"),n.videos={johnDies:{who:"John Smith",type:"death",assets:w.getAssets("johnDies")},johnLives:{who:"John Smith",type:"alive",assets:w.getAssets("johnLives")}},n.updateFootage(n.videos.johnDies),n}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&re(t,e)}(e,t),n=e,(i=[{key:"setActive",value:function(){this.state="idle"}},{key:"appLoaded",value:function(){this.handler.getEntityManager().addEntity(new Ut(this.handler,this.footage,this.setActive.bind(this)))}},{key:"intervened",value:function(){console.log("footage intervened!"),this.updateFootage(this.videos.johnLives)}},{key:"updateFootage",value:function(t){var e=te(this.handler.getEntityManager().getEntitiesByType(h.TYPES.COMPUTER),1)[0],n={x:e.x,y:e.y};this.footage=[new Qt(this.handler,n.x,n.y,t,!1)]}}])&&ee(n.prototype,i),r&&ee(n,r),e}(st);function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function he(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ue(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fe=function(t){function e(t,n,i){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ue(this,ce(e).call(this,t,n,i))).states={OFF:"off",INITIALIZE:"initialize",BOOTING:"booting",IDLE:"idle"},r.width=h.SCREEN_WIDTH,r.height=h.SCREEN_HEIGHT,r.bounds={x:4,y:4,width:r.width-4,height:r.height-4},r.assets=w.getAssets("os"),r.padding=32,r.iconsPerRow=4,r.bootCounter=0,r.bootWait=0,r.type=h.TYPES.INTERACTIVE;r.handler.getEntityManager();return r.state=r.states.OFF,r}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(e,t),n=e,(i=[{key:"initializeApps",value:function(){this.apps=[this.handler.getEntityManager().addEntity(new Ht(this.handler))]}},{key:"addApp",value:function(t){this.apps.push(t),this.handler.getEntityManager().addEntity(t),this.resetAppPositions()}},{key:"alignIconsTopLeftToBottomRight",value:function(){var t=this.x,e=this.y;e+=this.padding;for(var n=0;n<this.apps.length;n+=1){var i=this.apps[n];t+=this.padding,n%this.iconsPerRow==0&&0!==n&&(e+=i.height+this.padding,t=this.x+this.padding),i.x=t,i.y=e,t+=i.width,t+=this.padding}}},{key:"resetAppPositions",value:function(){var t=this.x+this.width/2,e=this.y+this.height/2;if(1===this.apps.length){var n=se(this.apps,1)[0];return n.x=t-n.bounds.width/2,void(n.y=e-n.bounds.height)}if(2===this.apps.length){var i=se(this.apps,2),r=i[0],o=i[1];return r.x=t-r.bounds.width/2-96,r.y=e-r.bounds.height,o.x=t-o.bounds.width/2+96,void(o.y=e-o.bounds.height)}throw new Error("apps length is great then expected (".concat(this.apps.length,") in ComputerScreen.resetAppPositions()"))}},{key:"tick",value:function(){switch(this.state){case this.states.OFF:break;case this.states.INITIALIZE:this.initializeApps(),this.resetAppPositions(),this.state=this.states.BOOTING;break;case this.states.IDLE:break;case this.states.BOOTING:var t=this.assets.animations[this.states.BOOTING];if(t.index>=9)return this.bootCounter+=1,void(this.bootCounter>=this.bootWait&&(this.bootCounter=0,this.state=this.states.IDLE));t.tick();break;default:throw new Error('Computer Screen animation state "'.concat(this.state," is not accounted for"))}}},{key:"getCurrentAnimationFrame",value:function(){switch(this.state){case this.states.OFF:case this.states.INITIALIZE:case this.states.IDLE:break;case this.states.BOOTING:return this.assets.animations[this.states.BOOTING].getCurrentFrame();default:throw new Error('Computer App animation state "'.concat(this.state," is not accounted for"))}}},{key:"render",value:function(t){switch(t.fillStyle=this.state===this.states.OFF?"black":h.COLORS.PURPLE,t.fillRect(this.x,this.y,this.width,this.height),this.state){case this.states.OFF:case this.states.INITIALIZE:break;case this.states.IDLE:for(var e=0;e<this.apps.length;e+=1){var n=this.apps[e];t.drawText(n.name,n.x+n.textXOffset,n.y+n.textYOffset),n.render(t)}break;case this.states.BOOTING:this.bootCounter>this.bootWait/4&&(t.globalAlpha-=this.bootCounter/this.bootWait),t.drawSprite(this.getCurrentAnimationFrame(),this.x,this.y,this.width,this.height),t.globalAlpha=1;break;default:throw new Error('Computer App animation state "'.concat(this.state," is not accounted for"))}}},{key:"wasClickedAt",value:function(t,e){this.state===this.states.OFF&&(this.type=h.TYPES.COMPUTER,this.state=this.states.INITIALIZE)}}])&&he(n.prototype,i),r&&he(n,r),e}(tt);function de(t){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ye(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pe(t,e){return!e||"object"!==de(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function be(t,e){return(be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ve=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=pe(this,ge(e).call(this,t,h.DIALOGUE.X,h.DIALOGUE.Y))).x=h.DIALOGUE.X,i.y=h.DIALOGUE.Y,i.width=h.DIALOGUE.WIDTH,i.height=h.DIALOGUE.HEIGHT,i.bounds={x:-i.x,y:-i.y,width:h.GAME_WIDTH,height:h.GAME_HEIGHT},i.fontSize=42,i.textX=i.x+i.fontSize,i.textY=i.y+i.height/2+i.fontSize/3,i.type=h.TYPES.INTERACTIVE,i.dialogue="",i.speechTimer=5,i.wasClicked=!1,i.words=[],i.addWords(n),i}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&be(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(t){if(!this.words.length)return this.handler.getWorld().dialogueFinished(),void this.handler.getEntityManager().removeEntity(this);this.speechTimer>=2&&this.words.length&&(this.words[0].length?this.sayNextLetter():this.wasClicked&&(this.wasClicked=!1,this.readNextSentence())),this.speechTimer<30&&this.speechTimer++}},{key:"render",value:function(t){this.words[0]&&(t.fillStyle="black",t.globalAlpha=.6,t.fillRect(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),t.globalAlpha=1,t.fillStyle="white",t.fillRect(this.x,this.y,this.width,this.height),t.drawText(this.dialogue,this.textX,this.textY,"black",!1,this.fontSize),this.words[0].length||t.drawText(">>",this.x+this.width-96,this.y+this.height-8,"black",!1,64))}},{key:"readNextSentence",value:function(){this.words.splice(0,1),this.clean()}},{key:"clean",value:function(){this.dialogue="",this.sentencePause=0}},{key:"sayNextLetter",value:function(){var t=this.words[0][0];this.dialogue+=t,this.words[0].splice(0,1),this.speechTimer=0}},{key:"addWords",value:function(t){var e=this;t instanceof Array||(t=[t]),t.forEach((function(t){e.words.push(t.split(""))}))}},{key:"clear",value:function(){this.words=[],this.clean()}},{key:"wasClickedAt",value:function(){this.words[0].length||(this.wasClicked=!0)}}])&&ye(n.prototype,i),r&&ye(n,r),e}(tt);function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function me(t,e){return!e||"object"!==we(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ie(t){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Te(t,e){return(Te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ke=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=me(this,Ie(e).call(this,t,0,0))).width=h.GAME_WIDTH,n.height=h.GAME_HEIGHT,n.states={INIT:"init",IDLE:"idle"},n.bounds={x:0,y:0,width:0,height:0},n.state=n.states.INIT,n.parentWindow=document.querySelector("#main"),n}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Te(t,e)}(e,t),n=e,(i=[{key:"initIframe",value:function(){this.wrapper=document.createElement("div");var t=document.createElement("iframe");this.wrapper.style.cursor="auto",this.wrapper.style.width="".concat(this.width,"px"),this.wrapper.style.height="".concat(this.height,"px"),this.wrapper.style.position="absolute",t.style.width=this.wrapper.style.width,t.style.height=this.wrapper.style.height,this.wrapper.setAttribute("z-index","9999"),t.setAttribute("z-index","9998"),t.setAttribute("src",this.src),this.parentWindow.appendChild(this.wrapper),this.wrapper.appendChild(t),this.initGameHeader()}},{key:"initGameHeader",value:function(){var t=document.createElement("div");t.setAttribute("id","game-header");var e=t.style;e.width="".concat(this.width+4,"px"),e.height="40px",e.position="absolute",e.top="0px",e.borderRadius="1%",e.border="2px black solid",t.setAttribute("z-index","9999"),this.wrapper.appendChild(t),this.initGameHeaderStripes(t),this.initGameHeaderCloseButton(t)}},{key:"initGameHeaderStripes",value:function(t){var e=document.createElement("div");e.style.height="100%",e.style.width="95%",e.style.display="inline-block",t.appendChild(e);for(var n=0;n<3;n+=1){var i=document.createElement("div");i.style.height="33%",i.style.backgroundColor=0===n?h.COLORS.PURPLE:1===n?h.COLORS.CREAM:h.COLORS.RED,e.appendChild(i)}}},{key:"initGameHeaderCloseButton",value:function(t){var e=document.createElement("div"),n=e.style;n.display="inline-block",n.width="4%",n.backgroundColor="lightgrey",n.height="80%",n.borderLeftColor="grey",n.borderTopColor="white",n.borderRightColor="white",n.borderBottomColor="grey",n.borderWidth="4px",n.borderStyle="solid",n.position="relative",t.appendChild(e);var i=document.createElement("h2");i.innerHTML="X",i.style.position="absolute",i.style.top="-17px",i.style.right="11px",e.appendChild(i),e.addEventListener("click",this.closeSelf.bind(this))}},{key:"closeSelf",value:function(){this.parentWindow.removeChild(this.wrapper),this.destroySelf()}},{key:"tick",value:function(){switch(this.state){case this.states.INIT:if(!this.src)throw new Error("Easter egg game has no .src!");this.initIframe(),this.state=this.states.IDLE;break;case this.states.IDLE:break;default:throw new Error('Easter Egg Game state "'.concat(this.state," is not accounted for"))}}},{key:"render",value:function(t){}}])&&Ee(n.prototype,i),r&&Ee(n,r),e}(tt);function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t,e){return!e||"object"!==Oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ae(t){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _e(t,e){return(_e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Me=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Se(this,Ae(e).call(this,t))).src="https://mccordgh.github.io/js13kgames_2017_entry/",n.title="Me, Myself, and i",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_e(t,e)}(e,t),e}(ke);function Pe(t){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function He(t,e){return!e||"object"!==Pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Re=function(t){function e(t,n,i){var r,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=He(this,je(e).call(this,t,n,i))).width=h.RADIO_WIDTH,a.height=h.RADIO_HEIGHT,a.bounds={x:0,y:22,width:a.width,height:a.height-22},a.type=h.TYPES.INTERACTIVE,a.assets=w.getAssets("radio"),a.bannerAssets=w.getAssets("radioBanner"),a.states={OFF:"off",STATION1:"station-1",STATION2:"station-2",STATION3:"station-3"},a.state=a.states.OFF,a.titles=(Ce(r={},a.states.STATION1,"Dirt"),Ce(r,a.states.STATION2,"Råtten"),Ce(r,a.states.STATION3,"B-L-U-E"),r),a.artists=(Ce(o={},a.states.STATION1,"The Greebles"),Ce(o,a.states.STATION2,"Black Eyeball"),Ce(o,a.states.STATION3,"The Clue-sters"),o),a.bannerCounter=0,a.showBannerMax=360,a.showBanner=!1,a}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ge(t,e)}(e,t),n=e,(i=[{key:"tick",value:function(){this.showBanner&&(this.bannerCounter+=1,this.bannerCounter>=this.showBannerMax&&(this.showBanner=!1,this.bannerCounter=0))}},{key:"startBanner",value:function(){this.bannerCounter=0,this.showBanner=!0}},{key:"render",value:function(t){var e;switch(this.state){case this.states.OFF:e=this.assets.off;break;case this.states.STATION1:e=this.assets.station1;break;case this.states.STATION2:e=this.assets.station2;break;case this.states.STATION3:e=this.assets.station3}t.drawSprite(e,this.x,this.y,this.width,this.height),this.state!==this.states.OFF&&this.showBanner&&this.drawRadioBanner(t)}},{key:"drawRadioBanner",value:function(t){var e=this.x-36,n=this.y+46;t.drawSprite(this.bannerAssets.img,e,n,225,225),e+=40,n+=106,t.drawText("Now Playing:",e,n,"black",!0,18),n+=22,t.drawText(this.titles[this.state],e,n,"black",!0,18),n+=22,t.drawText(this.artists[this.state],e,n,"black",!0,18)}},{key:"wasClickedAt",value:function(t,e){var n=this.handler.getSoundManager();switch(this.state){case this.states.OFF:this.state=this.states.STATION1,n.play("station1");break;case this.states.STATION1:this.state=this.states.STATION2,n.play("station2");break;case this.states.STATION2:this.state=this.states.STATION3,n.play("station3");break;case this.states.STATION3:this.state=this.states.OFF,n.play("bgm")}this.state!==this.states.OFF&&this.startBanner()}}])&&xe(n.prototype,i),r&&xe(n,r),e}(tt);function De(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ne=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.entityManager=e.createEntityManager(),this.assets={background:w.getAssets("background").image},this.spatialGrid=new Z(h.GAME_WIDTH,h.GAME_HEIGHT,h.SPATIAL_GRID_SIZE),this.states={INITIALIZE:"initialize",INTRO:"intro",IDLE:"idle",TEST:"test",TEST_INIT:"test-init",GAME_WON:"game-won"},this.state=this.states.INITIALIZE}var e,n,i;return e=t,(n=[{key:"initDialogue",value:function(){this.dialogue=this.entityManager.addEntity(new ve(this.handler,[]))}},{key:"gameWon",value:function(){this.dialogue=this.entityManager.addEntity(new ve(this.handler,["Yo, newbie! You did it!","Looks like John Smith is alive!","Great Job!","Also we need you in on Saturday..."])),this.state=this.states.GAME_WON}},{key:"dialogueFinished",value:function(){switch(this.state){case this.states.INITIALIZE:break;case this.states.INTRO:this.state=this.states.IDLE;break;case this.states.IDLE:this.spatialGrid.render(graphics),this.entityManager.render(graphics);break;case this.states.GAME_WON:console.log("game won dialogue finished");break;default:throw new Error('World One animation state "'.concat(this.state," is not accounted for"))}}},{key:"loadEntities",value:function(){var t=this;[new fe(this.handler,256,136),new Re(this.handler,52,62)].forEach((function(e){t.entityManager.addEntity(e)}))}},{key:"tick",value:function(t){switch(this.state){case this.states.TEST_INIT:this.entityManager.addEntity(new Me(this.handler)),this.state=this.states.IDLE;break;case this.states.TEST:break;case this.states.INITIALIZE:this.initDialogue(),this.state=this.states.INTRO;break;case this.states.GAME_WON:case this.states.INTRO:this.dialogue&&this.dialogue.tick();break;case this.states.IDLE:break;default:throw new Error('World One animation state "'.concat(this.state," is not accounted for"))}this.entityManager.tick(t)}},{key:"render",value:function(t){switch(this.drawBackground(t),this.state){case this.states.TEST_INIT:case this.states.INITIALIZE:break;case this.states.GAME_WON:case this.states.INTRO:this.dialogue&&this.dialogue.render(t);break;case this.states.TEST:case this.states.IDLE:break;default:throw new Error('World One state "'.concat(this.state," is not accounted for"))}this.entityManager.render(t)}},{key:"init",value:function(){this.loadEntities()}},{key:"drawBackground",value:function(t){var e=this.assets.background;t.drawSprite(e)}},{key:"getSpatialGrid",value:function(){return this.spatialGrid}}])&&De(e.prototype,n),i&&De(e,i),t}();function Fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Le(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e}var e,n,i;return e=t,(n=[{key:"unlockApp",value:function(t){var e=Fe(this.handler.getEntityManager().getEntitiesByType(h.TYPES.COMPUTER),1)[0];switch(t){case h.APPS.FOOTAGE:this.appExistsOnComputer(e,h.APPS.FOOTAGE)||e.addApp(new oe(this.handler));break;default:throw new Error("".concat(t," is not a valid app name to unlock"))}}},{key:"appExistsOnComputer",value:function(t,e){return!!t.apps.find((function(t){return t.name===e}))}}])&&Le(e.prototype,n),i&&Le(e,i),t}();function We(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ye=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.log={john:{intervened:!1,watchedBestVideo:!1}}}var e,n,i;return e=t,(n=[{key:"updateIntervened",value:function(){console.log("intervened!!"),this.log.john.intervened=!0;var t=this.handler.getEntityManager().findEntityByName(h.APPS.FOOTAGE);console.log({footage:t}),t.intervened()}},{key:"updateWatchedBestVideo",value:function(){console.log("watched best vid!"),this.log.john.watchedBestVideo=!0}},{key:"isLogComplete",value:function(){return!!this.log.john.intervened&&!!this.log.john.watchedBestVideo}}])&&We(e.prototype,n),i&&We(e,i),t}();function ze(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ue=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sources={bgm:this.getMusic("bgm"),station1:this.getMusic("station1"),station2:this.getMusic("station2"),station3:this.getMusic("station3")};this.sources.bgm;this.lastSoundPlayed=this.play("bgm")}var e,n,i;return e=t,(n=[{key:"getMusic",value:function(t){return"".concat(h.MUSIC_PATH,"/").concat(t,".mp3")}},{key:"stopSound",value:function(t){t.pause(),t.currentTime=0,t.src=""}},{key:"initSound",value:function(t){var e=new Audio(t);return e.loop=!0,e}},{key:"play",value:function(t){var e=this.sources[t];if(e)try{this.lastSoundPlayed&&this.stopSound(this.lastSoundPlayed);var n=this.initSound(e);return n.play(),this.lastSoundPlayed=n,n}catch(t){throw new Error(t)}throw new Error('Sound with name "'.concat(t,'" not found.'))}}])&&ze(e.prototype,n),i&&ze(e,i),t}();function Xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ze=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.entityManager=null,this.graphicsManager=null,this.monsterManager=null,this.mouseManager=null,this.seedManager=null,this.stateManager=null,this.uiManager=null,this.world=null}var e,n,i;return e=t,(n=[{key:"getEmailManager",value:function(){return this.emailManager}},{key:"getFootageManager",value:function(){return this.footageManager}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getGame",value:function(){return this.game}},{key:"getGraphicsManager",value:function(){return this.graphicsManager}},{key:"getMouseManager",value:function(){return this.mouseManager}},{key:"getSoundManager",value:function(){return this.soundManager}},{key:"getWorld",value:function(){return this.world}},{key:"createEntityManager",value:function(){return this.entityManager=new Y(this)}},{key:"createEmailManager",value:function(){return this.emailManager=new Be(this)}},{key:"createFootageManager",value:function(){return this.footageManager=new Ye(this)}},{key:"createGraphicsManager",value:function(){return this.graphicsManager=new c}},{key:"createMouseManager",value:function(){return this.mouseManager=new a(this)}},{key:"createSoundManager",value:function(){return this.soundManager=new Ue(this)}},{key:"createStateManager",value:function(){return this.stateManager=new U}},{key:"createWorld",value:function(){return this.world=new Ne(this)}},{key:"event",value:function(t,e){"click"===t&&this.entityManager.mouseClick(e),"move"===t&&this.entityManager.mouseMove(e)}}])&&Xe(e.prototype,n),i&&Xe(e,i),t}();function Ve(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Je=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"initialize",value:function(){this.managerHandler=new Ze(this),this.graphicsManager=this.managerHandler.createGraphicsManager(),this.stateManager=this.managerHandler.createStateManager(),this.mouseManager=this.managerHandler.createMouseManager(),this.managerHandler.createEmailManager(),this.managerHandler.createFootageManager(),this.managerHandler.createSoundManager();var t=this.managerHandler.createWorld();t.init();var e=new r(this.managerHandler,t);this.stateManager.setState(e)}},{key:"run",value:function(){var t=this;this.initialize();var e=1e3/h.FPS,n=0,i=a/1e3,r=Date.now(),o=r,a=0;!function s(){r=Date.now(),n=r-o,o=r,(a+=n)>=e&&(i=a/1e3,t.tick(i),t.render(t.graphicsManager.getGraphics()),a=0),window.requestAnimationFrame(s)}()}},{key:"tick",value:function(t){this.stateManager.getState().tick(t)}},{key:"render",value:function(t){t.clearRect(0,0,h.GAME_WIDTH,h.GAME_HEIGHT),this.stateManager.getState().render(t)}}])&&Ve(e.prototype,n),i&&Ve(e,i),t}();document.title="Gamedev.js 2020",(new Je).run()}]);